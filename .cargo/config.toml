[build]
target = "xtensa-esp32s3-none-elf"

[alias]
t = "test --target x86_64-unknown-linux-gnu"

[target.xtensa-esp32s3-none-elf]
runner = "espflash flash --monitor"
rustflags = [
    "-C", "link-arg=-nostartfiles",
    "-C", "link-arg=-Tlinkall.x",
    "-C", "link-arg=-u", "-C", "link-arg=esp_app_desc",
]

[env]
ESP_LOG = "INFO"

# Build commands (run 'source ~/export-esp.sh' first):
# - Host tests: cargo t
# - Embedded build: cargo +esp build --features embedded --release -Zbuild-std=core,alloc
# - Flash: espflash flash --port /dev/ttyACM0 target/xtensa-esp32s3-none-elf/release/walkie-textie-rust-firmware
